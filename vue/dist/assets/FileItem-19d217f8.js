var St=Object.defineProperty;var kt=(i,n,e)=>n in i?St(i,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[n]=e;var se=(i,n,e)=>(kt(i,typeof n!="symbol"?n+"":n,e),e);import{d as ne,u as Ze,G as x,an as Xe,h as q,c as _,aq as At,dl as _t,r as U,bh as It,Z as F,dj as wt,P as Be,ca as Ct,A as ie,dm as pe,O as ye,am as ue,bk as Tt,d7 as Et,b$ as Pt,dn as $t,cH as Ot,dp as Fe,dq as Dt,p as Nt,dr as et,bB as zt,ds as Te,dt as Mt,aH as Qt,du as Bt,C as Ft,dv as Rt,dw as Re,dx as Lt,n as be,m as ce,aU as jt,t as tt,a1 as Ee,c8 as nt,aJ as Vt,dy as it,dz as Ht,Q as Ut,x as Jt,cs as Se,cS as st,cT as rt,aP as Pe,aQ as $e,az as ot,U as o,a2 as V,dA as xt,dB as Wt,dC as Kt,c4 as Gt,dD as Yt,at as qt,V as u,aG as re,$ as k,a3 as I,a8 as K,c5 as Le,c6 as Zt,dE as Xt,a7 as lt,ag as G,X as A,Y as h,a4 as L,al as at,de as en,dd as tn,M as dt,W as a,a0 as ut,d8 as nn,dF as je,af as sn,dG as rn,db as on,dH as ln,dI as an,dJ as ve,cM as dn,dK as un,dL as cn,dM as fn}from"./index-dc37bc47.js";import"./numInput.vue_vue_type_style_index_0_scoped_bd954eda_lang-5df4472c.js";import{i as hn}from"./_isIterateeCall-75bdffcd.js";import{D as ee,a as ke}from"./index-5cdd54c3.js";/* empty css              */var gn=function(){return{prefixCls:String,checked:{type:Boolean,default:void 0},onChange:{type:Function},onClick:{type:Function},"onUpdate:checked":Function}},pn=ne({compatConfig:{MODE:3},name:"ACheckableTag",props:gn(),setup:function(n,e){var t=e.slots,s=e.emit,l=Ze("tag",n),v=l.prefixCls,f=function($){var E=n.checked;s("update:checked",!E),s("change",!E),s("click",$)},g=x(function(){var S;return Xe(v.value,(S={},q(S,"".concat(v.value,"-checkable"),!0),q(S,"".concat(v.value,"-checkable-checked"),n.checked),S))});return function(){var S;return _("span",{class:g.value,onClick:f},[(S=t.default)===null||S===void 0?void 0:S.call(t)])}}});const Ae=pn;var vn=new RegExp("^(".concat(At.join("|"),")(-inverse)?$")),mn=new RegExp("^(".concat(_t.join("|"),")$")),yn=function(){return{prefixCls:String,color:{type:String},closable:{type:Boolean,default:!1},closeIcon:Be.any,visible:{type:Boolean,default:void 0},onClose:{type:Function},"onUpdate:visible":Function,icon:Be.any}},te=ne({compatConfig:{MODE:3},name:"ATag",props:yn(),slots:["closeIcon","icon"],setup:function(n,e){var t=e.slots,s=e.emit,l=e.attrs,v=Ze("tag",n),f=v.prefixCls,g=v.direction,S=U(!0);It(function(){n.visible!==void 0&&(S.value=n.visible)});var $=function(d){d.stopPropagation(),s("update:visible",!1),s("close",d),!d.defaultPrevented&&n.visible===void 0&&(S.value=!1)},E=x(function(){var Q=n.color;return Q?vn.test(Q)||mn.test(Q):!1}),O=x(function(){var Q;return Xe(f.value,(Q={},q(Q,"".concat(f.value,"-").concat(n.color),E.value),q(Q,"".concat(f.value,"-has-color"),n.color&&!E.value),q(Q,"".concat(f.value,"-hidden"),!S.value),q(Q,"".concat(f.value,"-rtl"),g.value==="rtl"),Q))});return function(){var Q,d,c,y=n.icon,r=y===void 0?(Q=t.icon)===null||Q===void 0?void 0:Q.call(t):y,p=n.color,w=n.closeIcon,b=w===void 0?(d=t.closeIcon)===null||d===void 0?void 0:d.call(t):w,T=n.closable,D=T===void 0?!1:T,R=function(){return D?b?_("span",{class:"".concat(f.value,"-close-icon"),onClick:$},[b]):_(Ct,{class:"".concat(f.value,"-close-icon"),onClick:$},null):null},N={backgroundColor:p&&!E.value?p:void 0},H=r||null,m=(c=t.default)===null||c===void 0?void 0:c.call(t),B=H?_(F,null,[H,_("span",null,[m])]):m,z="onClick"in l,j=_("span",{class:O.value,style:N},[B,R()]);return z?_(wt,null,{default:function(){return[j]}}):j}}});te.CheckableTag=Ae;te.install=function(i){return i.component(te.name,te),i.component(Ae.name,Ae),i};const bn=te;ee.Button=ke;ee.install=function(i){return i.component(ee.name,ee),i.component(ke.name,ke),i};var Sn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z"}}]},name:"star",theme:"filled"};const kn=Sn;function Ve(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){An(i,s,e[s])})}return i}function An(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Oe=function(n,e){var t=Ve({},n,e.attrs);return _(ie,Ve({},t,{icon:kn}),null)};Oe.displayName="StarFilled";Oe.inheritAttrs=!1;const ct=Oe;var _n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file",theme:"outlined"};const In=_n;function He(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){wn(i,s,e[s])})}return i}function wn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var De=function(n,e){var t=He({},n,e.attrs);return _(ie,He({},t,{icon:In}),null)};De.displayName="FileOutlined";De.inheritAttrs=!1;const Cn=De;var Tn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"}}]},name:"folder-open",theme:"outlined"};const En=Tn;function Ue(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){Pn(i,s,e[s])})}return i}function Pn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Ne=function(n,e){var t=Ue({},n,e.attrs);return _(ie,Ue({},t,{icon:En}),null)};Ne.displayName="FolderOpenOutlined";Ne.inheritAttrs=!1;const $n=Ne;function On(i){return i&&i.length?i[0]:void 0}var Dn=Math.ceil,Nn=Math.max;function zn(i,n,e,t){for(var s=-1,l=Nn(Dn((n-i)/(e||1)),0),v=Array(l);l--;)v[t?l:++s]=i,i+=e;return v}function Mn(i){return function(n,e,t){return t&&typeof t!="number"&&hn(n,e,t)&&(e=t=void 0),n=pe(n),e===void 0?(e=n,n=0):e=pe(e),t=t===void 0?n<e?1:-1:pe(t),zn(n,e,t,i)}}var Qn=Mn();const Bn=Qn,Fn="data:image/png;base64,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",oe=new WeakMap;function Rn(i,n){return{useHookShareState:t=>{const s=Pt();ye(s),oe.has(s)||(oe.set(s,ue(i(s,t??(n==null?void 0:n())))),Tt(()=>{oe.delete(s)}));const l=oe.get(s);return ye(l),{state:l,toRefs(){return Et(l)}}}}}var Ln={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};const jn=Ln;function Je(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){Vn(i,s,e[s])})}return i}function Vn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var ze=function(n,e){var t=Je({},n,e.attrs);return _(ie,Je({},t,{icon:jn}),null)};ze.displayName="CaretRightOutlined";ze.inheritAttrs=!1;const xe=ze;var Hn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"}}]},name:"star",theme:"outlined"};const Un=Hn;function We(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){Jn(i,s,e[s])})}return i}function Jn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Me=function(n,e){var t=We({},n,e.attrs);return _(ie,We({},t,{icon:Un}),null)};Me.displayName="StarOutlined";Me.inheritAttrs=!1;const ft=Me,xn="/infinite_image_browsing/fe-static/assets/play-ef9d181b.svg",Wn=$t("useBatchDownloadStore",()=>{const i=U([]);return{selectdFiles:i,addFiles:e=>{i.value=Ot([...i.value,...e])}}});class fe{constructor(n,e=Dt.CREATED_TIME_DESC){se(this,"root");se(this,"execQueue",[]);se(this,"walkerInitPromsie");this.entryPath=n,this.sortMethod=e,this.root={children:[],info:{name:this.entryPath,size:"-",bytes:0,created_time:"",is_under_scanned_path:!0,date:"",type:"dir",fullpath:this.entryPath}},this.walkerInitPromsie=new Promise(t=>{Fe([this.entryPath]).then(async s=>{this.root.info=s[this.entryPath],await this.fetchChildren(this.root),t()})})}reset(){return this.root.children=[],this.fetchChildren(this.root)}get images(){const n=e=>e.children.map(t=>{if(t.info.type==="dir")return n(t);if(Te(t.info.name))return t.info}).filter(t=>t).flat(1);return n(this.root)}get isCompleted(){return this.execQueue.length===0}async fetchChildren(n){const{files:e}=await Nt(n.info.fullpath);return n.children=et(e,this.sortMethod).map(t=>({info:t,children:[]})),this.execQueue.shift(),this.execQueue.unshift(...n.children.filter(t=>t.info.type==="dir").map(t=>({fn:()=>this.fetchChildren(t),...t}))),n}async next(){await this.walkerInitPromsie;const n=On(this.execQueue);if(!n)return null;const e=await n.fn();return this.execQueue=this.execQueue.slice(),this.root={...this.root},e}async isExpired(){const n=[this.root.info],e=s=>{for(const l of s.children)l.info.type==="dir"&&(n.push(l.info),e(l))};e(this.root);const t=await Fe(n.map(s=>s.fullpath));for(const s of n)if(!zt(s,t[s.fullpath]))return!0;return!1}async seamlessRefresh(n,e=U(!1)){const t=performance.now(),s=new fe(this.entryPath,this.sortMethod);for(await s.walkerInitPromsie;!s.isCompleted&&s.images.length<n;){if(e.value)throw new Error("canceled");await s.next()}const l=performance.now();return console.log("seamlessRefresh currPos:",n,"Time taken:",(l-t).toFixed(0),"ms"),s}}var ht={exports:{}};/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */(function(i,n){(function(e,t){i.exports=t})(Mt,function(){var e={};e.version="0.3.5";var t=e.settings={minimum:.08,easing:"linear",positionUsing:"",speed:200,trickle:!0,trickleSpeed:200,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};e.configure=function(d){var c,y;for(c in d)y=d[c],y!==void 0&&d.hasOwnProperty(c)&&(t[c]=y);return this},e.status=null,e.set=function(d){var c=e.isStarted();d=s(d,t.minimum,1),e.status=d===1?null:d;var y=e.render(!c),r=y.querySelector(t.barSelector),p=t.speed,w=t.easing;return y.offsetWidth,f(function(b){t.positionUsing===""&&(t.positionUsing=e.getPositioningCSS()),g(r,v(d,p,w)),d===1?(g(y,{transition:"none",opacity:1}),y.offsetWidth,setTimeout(function(){g(y,{transition:"all "+p+"ms linear",opacity:0}),setTimeout(function(){e.remove(),b()},p)},p)):setTimeout(b,p)}),this},e.isStarted=function(){return typeof e.status=="number"},e.start=function(){e.status||e.set(0);var d=function(){setTimeout(function(){e.status&&(e.trickle(),d())},t.trickleSpeed)};return t.trickle&&d(),this},e.done=function(d){return!d&&!e.status?this:e.inc(.3+.5*Math.random()).set(1)},e.inc=function(d){var c=e.status;return c?c>1?void 0:(typeof d!="number"&&(c>=0&&c<.2?d=.1:c>=.2&&c<.5?d=.04:c>=.5&&c<.8?d=.02:c>=.8&&c<.99?d=.005:d=0),c=s(c+d,0,.994),e.set(c)):e.start()},e.trickle=function(){return e.inc()},function(){var d=0,c=0;e.promise=function(y){return!y||y.state()==="resolved"?this:(c===0&&e.start(),d++,c++,y.always(function(){c--,c===0?(d=0,e.done()):e.set((d-c)/d)}),this)}}(),e.getElement=function(){var d=e.getParent();if(d){var c=Array.prototype.slice.call(d.querySelectorAll(".nprogress")).filter(function(y){return y.parentElement===d});if(c.length>0)return c[0]}return null},e.getParent=function(){if(t.parent instanceof HTMLElement)return t.parent;if(typeof t.parent=="string")return document.querySelector(t.parent)},e.render=function(d){if(e.isRendered())return e.getElement();$(document.documentElement,"nprogress-busy");var c=document.createElement("div");c.id="nprogress",c.className="nprogress",c.innerHTML=t.template;var y=c.querySelector(t.barSelector),r=d?"-100":l(e.status||0),p=e.getParent(),w;return g(y,{transition:"all 0 linear",transform:"translate3d("+r+"%,0,0)"}),t.showSpinner||(w=c.querySelector(t.spinnerSelector),w&&Q(w)),p!=document.body&&$(p,"nprogress-custom-parent"),p.appendChild(c),c},e.remove=function(){e.status=null,E(document.documentElement,"nprogress-busy"),E(e.getParent(),"nprogress-custom-parent");var d=e.getElement();d&&Q(d)},e.isRendered=function(){return!!e.getElement()},e.getPositioningCSS=function(){var d=document.body.style,c="WebkitTransform"in d?"Webkit":"MozTransform"in d?"Moz":"msTransform"in d?"ms":"OTransform"in d?"O":"";return c+"Perspective"in d?"translate3d":c+"Transform"in d?"translate":"margin"};function s(d,c,y){return d<c?c:d>y?y:d}function l(d){return(-1+d)*100}function v(d,c,y){var r;return t.positionUsing==="translate3d"?r={transform:"translate3d("+l(d)+"%,0,0)"}:t.positionUsing==="translate"?r={transform:"translate("+l(d)+"%,0)"}:r={"margin-left":l(d)+"%"},r.transition="all "+c+"ms "+y,r}var f=function(){var d=[];function c(){var y=d.shift();y&&y(c)}return function(y){d.push(y),d.length==1&&c()}}(),g=function(){var d=["Webkit","O","Moz","ms"],c={};function y(b){return b.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(T,D){return D.toUpperCase()})}function r(b){var T=document.body.style;if(b in T)return b;for(var D=d.length,R=b.charAt(0).toUpperCase()+b.slice(1),N;D--;)if(N=d[D]+R,N in T)return N;return b}function p(b){return b=y(b),c[b]||(c[b]=r(b))}function w(b,T,D){T=p(T),b.style[T]=D}return function(b,T){var D=arguments,R,N;if(D.length==2)for(R in T)N=T[R],N!==void 0&&T.hasOwnProperty(R)&&w(b,R,N);else w(b,D[1],D[2])}}();function S(d,c){var y=typeof d=="string"?d:O(d);return y.indexOf(" "+c+" ")>=0}function $(d,c){var y=O(d),r=y+c;S(y,c)||(d.className=r.substring(1))}function E(d,c){var y=O(d),r;S(d,c)&&(r=y.replace(" "+c+" "," "),d.className=r.substring(1,r.length-1))}function O(d){return(" "+(d&&d.className||"")+" ").replace(/\s+/gi," ")}function Q(d){d&&d.parentNode&&d.parentNode.removeChild(d)}return e})})(ht);var Kn=ht.exports;const Ar=Qt(Kn);function _r({fetchNext:i}={}){const{scroller:n,sortedFiles:e,sortMethod:t,currLocation:s,stackViewEl:l,canLoadNext:v,previewIdx:f,props:g,walker:S,getViewableAreaFiles:$}=he().toRefs(),{state:E}=he(),O=U(!1),Q=U(X.defaultGridCellWidth),d=x(()=>Q.value+16),c=44,{width:y}=Bt(l),r=x(()=>~~(y.value/d.value)),p=ue(new Map),w=ue(new Map),b=x(()=>{const m=d.value;return{first:m+(Q.value<=160?0:c),second:m}}),T=U(!1),D=async()=>{var m;if(!(T.value||g.value.mode!=="walk"||!v.value))try{T.value=!0,await((m=S.value)==null?void 0:m.next())}finally{T.value=!1}},R=async(m=!1)=>{const B=n.value,z=()=>m?f.value:(B==null?void 0:B.$_endIndex)??0,j=()=>{const P=e.value.length,W=50;return P?i?z()>P-W:z()>P-W&&v.value:!0};for(;j();){await tt(30);const P=await(i??D)();if(typeof P=="boolean"&&!P)return}};E.useEventListen("loadNextDir",Ft(async(m=!1)=>{await R(m),g.value.mode==="walk"&&N()})),E.useEventListen("viewableAreaFilesChange",()=>{const m=$.value(),B=m.filter(P=>P.is_under_scanned_path&&Te(P.name)).map(P=>P.fullpath);Gn.fetchImageTags(B);const z=m.filter(P=>P.is_under_scanned_path&&P.type==="dir"&&!p.has(P.fullpath)).map(P=>P.fullpath);z.length&&Rt(z).then(P=>{for(const W in P)if(Object.prototype.hasOwnProperty.call(P,W)){const J=P[W];p.set(W,J)}});const j=m.filter(P=>P.is_under_scanned_path&&P.type==="dir"&&!w.has(P.fullpath)).map(P=>P.fullpath);j.length&&Re(j,500).then(P=>{for(const W in P)Object.prototype.hasOwnProperty.call(P,W)&&w.set(W,P[W])})}),E.useEventListen("refresh",async()=>{p.clear(),w.clear(),await Lt(),E.eventEmitter.emit("viewableAreaFilesChange")}),E.useEventListen("invalidateFolderStats",async m=>{if(w.delete(m),e.value.filter(z=>z.type==="dir"&&z.fullpath===m).length>0){const z=await Re([m],500);z[m]&&w.set(m,z[m])}});const N=be(()=>E.eventEmitter.emit("viewableAreaFilesChange"),300);ce(s,N);const H=be(async()=>{await R(),N()},150);return{gridItems:r,sortedFiles:e,sortMethodConv:jt,moreActionsDropdownShow:O,gridSize:d,sortMethod:t,onScroll:H,loadNextDir:D,loadNextDirLoading:T,canLoadNext:v,itemSize:b,cellWidth:Q,dirCoverCache:p,dirStatsCache:w}}const Ir=new Map,X=Ee(),wr=Wn(),Gn=nt(),Cr=Vt(),Tr=new BroadcastChannel("iib-image-transfer-bus"),{eventEmitter:Er,useEventListen:Pr}=it(),{useHookShareState:he}=Rn((i,{images:n})=>{const e=U({tabIdx:-1,paneIdx:-1}),t=x(()=>Ut(s.value)),s=U([]),l=x(()=>{var T;return s.value.map(D=>D.curr).slice((T=X.conf)!=null&&T.is_win&&e.value.mode!=="scanned-fixed"?1:0)}),v=x(()=>Jt(...l.value)),f=x(()=>{var T,D;return e.value.mode==="scanned-fixed"?((D=(T=s.value)==null?void 0:T[0])==null?void 0:D.curr)??"":e.value.mode==="walk"?e.value.path??"":s.value.length===1?"/":v.value}),g=U(X.defaultSortingMethod),S=U(e.value.mode=="walk"?new fe(e.value.path,g.value):void 0);ce([()=>e.value.mode,()=>e.value.path,g],async([T,D,R])=>{var N;T==="walk"?(S.value=new fe(D,R),s.value=[{files:[],curr:D}],await tt(),await((N=S.value)==null?void 0:N.reset()),w.eventEmitter.emit("loadNextDir")):S.value=void 0});const $=ue(new Set);ce(t,()=>$.clear());const E=x(()=>{var N;if(n.value)return n.value;if(S.value)return S.value.images.filter(H=>!$.has(H.fullpath));if(!t.value)return[];const T=((N=t.value)==null?void 0:N.files)??[],D=g.value;return et((H=>{const m=X.fileTypeFilter;return m.includes("all")||m.length===0?H:H.filter(B=>!!(B.type==="dir"||m.includes("image")&&Se(B.name)||m.includes("video")&&st(B.name)||m.includes("audio")&&rt(B.name)))})(T),D).filter(H=>!$.has(H.fullpath))}),O=U([]),Q=U(-1),d=x(()=>S.value?!S.value.isCompleted:!1),c=U(!1),y=U(!1),r=U(),p=()=>{var T,D,R;return(R=(D=(T=X.tabList)==null?void 0:T[e.value.tabIdx])==null?void 0:D.panes)==null?void 0:R[e.value.paneIdx]},w=it();w.useEventListen("selectAll",()=>{console.log(`select all 0 -> ${E.value.length}`),O.value=Bn(0,E.value.length)});const b=()=>{const T=r.value;if(T){const D=Math.max(T.$_startIndex-10,0);return E.value.slice(D,T.$_endIndex+10)}return[]};return{previewing:y,spinning:c,canLoadNext:d,multiSelectedIdxs:O,previewIdx:Q,basePath:l,currLocation:f,currPage:t,stack:s,sortMethod:g,sortedFiles:E,scroller:r,stackViewEl:U(),props:e,getPane:p,walker:S,deletedFiles:$,getViewableAreaFiles:b,...w}},()=>({images:U()}));function $r(){const{eventEmitter:i,multiSelectedIdxs:n,sortedFiles:e}=he().toRefs();return{onSelectAll:()=>i.value.emit("selectAll"),onReverseSelect:()=>{n.value=e.value.map((v,f)=>f).filter(v=>!n.value.includes(v))},onClearAllSelected:()=>{n.value=[]}}}const Or=()=>{const{stackViewEl:i}=he().toRefs(),n=U(-1);return Ht(i,e=>{var s;let t=e.target;for(;t.parentElement;)if(t=t.parentElement,t.tagName.toLowerCase()==="li"&&t.classList.contains("file-item-trigger")){const l=(s=t.dataset)==null?void 0:s.idx;l&&Number.isSafeInteger(+l)&&(n.value=+l);return}}),{showMenuIdx:n}};function Yn(){var i=window.navigator.userAgent,n=i.indexOf("MSIE ");if(n>0)return parseInt(i.substring(n+5,i.indexOf(".",n)),10);var e=i.indexOf("Trident/");if(e>0){var t=i.indexOf("rv:");return parseInt(i.substring(t+3,i.indexOf(".",t)),10)}var s=i.indexOf("Edge/");return s>0?parseInt(i.substring(s+5,i.indexOf(".",s)),10):-1}let ae;function _e(){_e.init||(_e.init=!0,ae=Yn()!==-1)}var ge={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){_e(),ot(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const i=document.createElement("object");this._resizeObject=i,i.setAttribute("aria-hidden","true"),i.setAttribute("tabindex",-1),i.onload=this.addResizeHandlers,i.type="text/html",ae&&this.$el.appendChild(i),i.data="about:blank",ae||this.$el.appendChild(i)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!ae&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const qn=xt();Pe("data-v-b329ee4c");const Zn={class:"resize-observer",tabindex:"-1"};$e();const Xn=qn((i,n,e,t,s,l)=>(o(),V("div",Zn)));ge.render=Xn;ge.__scopeId="data-v-b329ee4c";ge.__file="src/components/ResizeObserver.vue";function de(i){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?de=function(n){return typeof n}:de=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},de(i)}function ei(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function Ke(i,n){for(var e=0;e<n.length;e++){var t=n[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(i,t.key,t)}}function ti(i,n,e){return n&&Ke(i.prototype,n),e&&Ke(i,e),i}function Ge(i){return ni(i)||ii(i)||si(i)||ri()}function ni(i){if(Array.isArray(i))return Ie(i)}function ii(i){if(typeof Symbol<"u"&&Symbol.iterator in Object(i))return Array.from(i)}function si(i,n){if(i){if(typeof i=="string")return Ie(i,n);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ie(i,n)}}function Ie(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}function ri(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oi(i){var n;return typeof i=="function"?n={callback:i}:n=i,n}function li(i,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t,s,l,v=function(g){for(var S=arguments.length,$=new Array(S>1?S-1:0),E=1;E<S;E++)$[E-1]=arguments[E];if(l=$,!(t&&g===s)){var O=e.leading;typeof O=="function"&&(O=O(g,s)),(!t||g!==s)&&O&&i.apply(void 0,[g].concat(Ge(l))),s=g,clearTimeout(t),t=setTimeout(function(){i.apply(void 0,[g].concat(Ge(l))),t=0},n)}};return v._clear=function(){clearTimeout(t),t=null},v}function gt(i,n){if(i===n)return!0;if(de(i)==="object"){for(var e in i)if(!gt(i[e],n[e]))return!1;return!0}return!1}var ai=function(){function i(n,e,t){ei(this,i),this.el=n,this.observer=null,this.frozen=!1,this.createObserver(e,t)}return ti(i,[{key:"createObserver",value:function(e,t){var s=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=oi(e),this.callback=function(f,g){s.options.callback(f,g),f&&s.options.once&&(s.frozen=!0,s.destroyObserver())},this.callback&&this.options.throttle){var l=this.options.throttleOptions||{},v=l.leading;this.callback=li(this.callback,this.options.throttle,{leading:function(g){return v==="both"||v==="visible"&&g||v==="hidden"&&!g}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(f){var g=f[0];if(f.length>1){var S=f.find(function(E){return E.isIntersecting});S&&(g=S)}if(s.callback){var $=g.isIntersecting&&g.intersectionRatio>=s.threshold;if($===s.oldResult)return;s.oldResult=$,s.callback($,g)}},this.options.intersection),ot(function(){s.observer&&s.observer.observe(s.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),i}();function pt(i,n,e){var t=n.value;if(t)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var s=new ai(i,t,e);i._vue_visibilityState=s}}function di(i,n,e){var t=n.value,s=n.oldValue;if(!gt(t,s)){var l=i._vue_visibilityState;if(!t){vt(i);return}l?l.createObserver(t,e):pt(i,{value:t},e)}}function vt(i){var n=i._vue_visibilityState;n&&(n.destroyObserver(),delete i._vue_visibilityState)}var ui={beforeMount:pt,updated:di,unmounted:vt},ci={itemsLimit:1e3},fi=/(auto|scroll)/;function mt(i,n){return i.parentNode===null?n:mt(i.parentNode,n.concat([i]))}var me=function(n,e){return getComputedStyle(n,null).getPropertyValue(e)},hi=function(n){return me(n,"overflow")+me(n,"overflow-y")+me(n,"overflow-x")},gi=function(n){return fi.test(hi(n))};function Ye(i){if(i instanceof HTMLElement||i instanceof SVGElement){for(var n=mt(i.parentNode,[]),e=0;e<n.length;e+=1)if(gi(n[e]))return n[e];return document.scrollingElement||document.documentElement}}function we(i){"@babel/helpers - typeof";return we=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},we(i)}var pi={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(n){return["vertical","horizontal"].includes(n)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function vi(){return this.items.length&&we(this.items[0])!=="object"}var Ce=!1;if(typeof window<"u"){Ce=!1;try{var mi=Object.defineProperty({},"passive",{get:function(){Ce=!0}});window.addEventListener("test",null,mi)}catch{}}let yi=0;var yt={name:"RecycleScroller",components:{ResizeObserver:ge},directives:{ObserveVisibility:ui},props:{...pi,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const i={"-1":{accumulator:0}},n=this.items,e=this.sizeField,t=this.minItemSize;let s=1e4,l=0,v;for(let f=0,g=n.length;f<g;f++)v=n[f][e]||t,v<s&&(s=v),l+=v,i[f]={accumulator:l,size:v};return this.$_computedMinItemSize=s,i}return[]},simpleArray:vi,itemIndexByKey(){const{keyField:i,items:n}=this,e={};for(let t=0,s=n.length;t<s;t++)e[n[t][i]]=t;return e}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const i=this.$_lastUpdateScrollPosition;typeof i=="number"&&this.$nextTick(()=>{this.scrollToPosition(i)})},beforeUnmount(){this.removeListeners()},methods:{addView(i,n,e,t,s){const l=Wt({id:yi++,index:n,used:!0,key:t,type:s}),v=Kt({item:e,position:0,nr:l});return i.push(v),v},unuseView(i,n=!1){const e=this.$_unusedViews,t=i.nr.type;let s=e.get(t);s||(s=[],e.set(t,s)),s.push(i),n||(i.nr.used=!1,i.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(i){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const n=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:e}=this.updateVisibleItems(!1,!0);e||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});n(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&n()},this.updateInterval))}},handleVisibilityChange(i,n){this.ready&&(i||n.boundingClientRect.width!==0||n.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(i,n=!1){const e=this.itemSize,t=this.gridItems||1,s=this.itemSecondarySize||e,l=this.$_computedMinItemSize,v=this.typeField,f=this.simpleArray?null:this.keyField,g=this.items,S=g.length,$=this.sizes,E=this.$_views,O=this.$_unusedViews,Q=this.pool,d=this.itemIndexByKey;let c,y,r,p,w;if(!S)c=y=p=w=r=0;else if(this.$_prerender)c=p=0,y=w=Math.min(this.prerender,g.length),r=null;else{const m=this.getScroll();if(n){let j=m.start-this.$_lastUpdateScrollPosition;if(j<0&&(j=-j),e===null&&j<l||j<e)return{continuous:!0}}this.$_lastUpdateScrollPosition=m.start;const B=this.buffer;m.start-=B,m.end+=B;let z=0;if(this.$refs.before&&(z=this.$refs.before.scrollHeight,m.start-=z),this.$refs.after){const j=this.$refs.after.scrollHeight;m.end+=j}if(e===null){let j,P=0,W=S-1,J=~~(S/2),Z;do Z=J,j=$[J].accumulator,j<m.start?P=J:J<S-1&&$[J+1].accumulator>m.start&&(W=J),J=~~((P+W)/2);while(J!==Z);for(J<0&&(J=0),c=J,r=$[S-1].accumulator,y=J;y<S&&$[y].accumulator<m.end;y++);for(y===-1?y=g.length-1:(y++,y>S&&(y=S)),p=c;p<S&&z+$[p].accumulator<m.start;p++);for(w=p;w<S&&z+$[w].accumulator<m.end;w++);}else{c=~~(m.start/e*t);const j=c%t;c-=j,y=Math.ceil(m.end/e*t),p=Math.max(0,Math.floor((m.start-z)/e*t)),w=Math.floor((m.end-z)/e*t),c<0&&(c=0),y>S&&(y=S),p<0&&(p=0),w>S&&(w=S),r=Math.ceil(S/t)*e}}y-c>ci.itemsLimit&&this.itemsLimitError(),this.totalSize=r;let b;const T=c<=this.$_endIndex&&y>=this.$_startIndex;if(T)for(let m=0,B=Q.length;m<B;m++)b=Q[m],b.nr.used&&(i&&(b.nr.index=d[b.item[f]]),(b.nr.index==null||b.nr.index<c||b.nr.index>=y)&&this.unuseView(b));const D=T?null:new Map;let R,N,H;for(let m=c;m<y;m++){R=g[m];const B=f?R[f]:R;if(B==null)throw new Error(`Key is ${B} on item (keyField is '${f}')`);if(b=E.get(B),!e&&!$[m].size){b&&this.unuseView(b);continue}N=R[v];let z=O.get(N),j=!1;if(!b)T?z&&z.length?b=z.pop():b=this.addView(Q,m,R,B,N):(H=D.get(N)||0,(!z||H>=z.length)&&(b=this.addView(Q,m,R,B,N),this.unuseView(b,!0),z=O.get(N)),b=z[H],D.set(N,H+1)),E.delete(b.nr.key),b.nr.used=!0,b.nr.index=m,b.nr.key=B,b.nr.type=N,E.set(B,b),j=!0;else if(!b.nr.used&&(b.nr.used=!0,b.nr.index=m,j=!0,z)){const P=z.indexOf(b);P!==-1&&z.splice(P,1)}b.item=R,j&&(m===g.length-1&&this.$emit("scroll-end"),m===0&&this.$emit("scroll-start")),e===null?(b.position=$[m-1].accumulator,b.offset=0):(b.position=Math.floor(m/t)*e,b.offset=m%t*s)}return this.$_startIndex=c,this.$_endIndex=y,this.emitUpdate&&this.$emit("update",c,y,p,w),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:T}},getListenerTarget(){let i=Ye(this.$el);return window.document&&(i===window.document.documentElement||i===window.document.body)&&(i=window),i},getScroll(){const{$el:i,direction:n}=this,e=n==="vertical";let t;if(this.pageMode){const s=i.getBoundingClientRect(),l=e?s.height:s.width;let v=-(e?s.top:s.left),f=e?window.innerHeight:window.innerWidth;v<0&&(f+=v,v=0),v+f>l&&(f=l-v),t={start:v,end:v+f}}else e?t={start:i.scrollTop,end:i.scrollTop+i.clientHeight}:t={start:i.scrollLeft,end:i.scrollLeft+i.clientWidth};return t},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,Ce?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(i){let n;const e=this.gridItems||1;this.itemSize===null?n=i>0?this.sizes[i-1].accumulator:0:n=Math.floor(i/e)*this.itemSize,this.scrollToPosition(n)},scrollToPosition(i){const n=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let e,t,s;if(this.pageMode){const l=Ye(this.$el),v=l.tagName==="HTML"?0:l[n.scroll],f=l.getBoundingClientRect(),S=this.$el.getBoundingClientRect()[n.start]-f[n.start];e=l,t=n.scroll,s=i+v+S}else e=this.$el,t=n.scroll,s=i;e[t]=s},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((i,n)=>i.nr.index-n.nr.index)}}};const bi={key:0,ref:"before",class:"vue-recycle-scroller__slot"},Si={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function ki(i,n,e,t,s,l){const v=Gt("ResizeObserver"),f=Yt("observe-visibility");return qt((o(),u("div",{class:G(["vue-recycle-scroller",{ready:s.ready,"page-mode":e.pageMode,[`direction-${i.direction}`]:!0}]),onScrollPassive:n[0]||(n[0]=(...g)=>l.handleScroll&&l.handleScroll(...g))},[i.$slots.before?(o(),u("div",bi,[re(i.$slots,"before")],512)):k("v-if",!0),(o(),V(Le(e.listTag),{ref:"wrapper",style:lt({[i.direction==="vertical"?"minHeight":"minWidth"]:s.totalSize+"px"}),class:G(["vue-recycle-scroller__item-wrapper",e.listClass])},{default:I(()=>[(o(!0),u(F,null,K(s.pool,g=>(o(),V(Le(e.itemTag),Zt({key:g.nr.id,style:s.ready?{transform:`translate${i.direction==="vertical"?"Y":"X"}(${g.position}px) translate${i.direction==="vertical"?"X":"Y"}(${g.offset}px)`,width:e.gridItems?`${i.direction==="vertical"&&e.itemSecondarySize||e.itemSize}px`:void 0,height:e.gridItems?`${i.direction==="horizontal"&&e.itemSecondarySize||e.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[e.itemClass,{hover:!e.skipHover&&s.hoverKey===g.nr.key}]]},Xt(e.skipHover?{}:{mouseenter:()=>{s.hoverKey=g.nr.key},mouseleave:()=>{s.hoverKey=null}})),{default:I(()=>[re(i.$slots,"default",{item:g.item,index:g.nr.index,active:g.nr.used})]),_:2},1040,["style","class"]))),128)),re(i.$slots,"empty")]),_:3},8,["style","class"])),i.$slots.after?(o(),u("div",Si,[re(i.$slots,"after")],512)):k("v-if",!0),_(v,{onNotify:l.handleResize},null,8,["onNotify"])],34)),[[f,l.handleVisibilityChange]])}yt.render=ki;yt.__file="src/components/RecycleScroller.vue";const qe=ne({__name:"ContextMenu",props:{file:{},idx:{},selectedTag:{},isSelectedMutilFiles:{type:Boolean}},emits:["contextMenuClick"],setup(i,{emit:n}){const e=i,t=Ee(),s=x(()=>{var l;return(((l=t.conf)==null?void 0:l.all_custom_tags)??[]).reduce((v,f)=>[...v,{...f,selected:!!e.selectedTag.find(g=>g.id===f.id)}],[])});return(l,v)=>{const f=at,g=en,S=tn,$=dt;return o(),V($,{onClick:v[0]||(v[0]=E=>n("contextMenuClick",E,l.file,l.idx))},{default:I(()=>{var E;return[_(f,{key:"deleteFiles"},{default:I(()=>[A(h(l.$t("deleteSelected")),1)]),_:1}),_(f,{key:"openWithDefaultApp"},{default:I(()=>[A(h(l.$t("openWithDefaultApp")),1)]),_:1}),_(f,{key:"saveSelectedAsJson"},{default:I(()=>[A(h(l.$t("saveSelectedAsJson")),1)]),_:1}),l.file.type==="dir"?(o(),u(F,{key:0},[_(f,{key:"openInNewTab"},{default:I(()=>[A(h(l.$t("openInNewTab")),1)]),_:1}),_(f,{key:"openOnTheRight"},{default:I(()=>[A(h(l.$t("openOnTheRight")),1)]),_:1}),_(f,{key:"openWithWalkMode"},{default:I(()=>[A(h(l.$t("openWithWalkMode")),1)]),_:1})],64)):k("",!0),l.file.type==="file"?(o(),u(F,{key:1},[L(Te)(l.file.name)?(o(),u(F,{key:0},[_(f,{key:"viewGenInfo"},{default:I(()=>[A(h(l.$t("viewGenerationInfo")),1)]),_:1}),_(f,{key:"tiktokView"},{default:I(()=>[A(h(l.$t("tiktokView")),1)]),_:1}),_(g),((E=L(t).conf)==null?void 0:E.launch_mode)!=="server"?(o(),u(F,{key:0},[_(f,{key:"send2txt2img"},{default:I(()=>[A(h(l.$t("sendToTxt2img")),1)]),_:1}),_(f,{key:"send2img2img"},{default:I(()=>[A(h(l.$t("sendToImg2img")),1)]),_:1}),_(f,{key:"send2inpaint"},{default:I(()=>[A(h(l.$t("sendToInpaint")),1)]),_:1}),_(f,{key:"send2extras"},{default:I(()=>[A(h(l.$t("sendToExtraFeatures")),1)]),_:1}),_(S,{key:"sendToThirdPartyExtension",title:l.$t("sendToThirdPartyExtension")},{default:I(()=>[_(f,{key:"send2controlnet-txt2img"},{default:I(()=>[A("ControlNet - "+h(l.$t("t2i")),1)]),_:1}),_(f,{key:"send2controlnet-img2img"},{default:I(()=>[A("ControlNet - "+h(l.$t("i2i")),1)]),_:1}),_(f,{key:"send2outpaint"},{default:I(()=>[A("openOutpaint")]),_:1})]),_:1},8,["title"])],64)):k("",!0),_(f,{key:"send2BatchDownload"},{default:I(()=>[A(h(l.$t("sendToBatchDownload")),1)]),_:1}),_(S,{key:"copy2target",title:l.$t("copyTo")},{default:I(()=>[(o(!0),u(F,null,K(L(t).quickMovePaths,O=>(o(),V(f,{key:`copy-to-${O.dir}`},{default:I(()=>[A(h(O.zh),1)]),_:2},1024))),128))]),_:1},8,["title"]),_(S,{key:"move2target",title:l.$t("moveTo")},{default:I(()=>[(o(!0),u(F,null,K(L(t).quickMovePaths,O=>(o(),V(f,{key:`move-to-${O.dir}`},{default:I(()=>[A(h(O.zh),1)]),_:2},1024))),128))]),_:1},8,["title"]),_(g),l.isSelectedMutilFiles?(o(),u(F,{key:1},[_(S,{key:"batch-add-tag",title:l.$t("batchAddTag")},{default:I(()=>[_(f,{key:"add-custom-tag"},{default:I(()=>[A("+ "+h(l.$t("addNewCustomTag")),1)]),_:1}),(o(!0),u(F,null,K(s.value,O=>(o(),V(f,{key:`batch-add-tag-${O.id}`},{default:I(()=>[A(h(O.name),1)]),_:2},1024))),128))]),_:1},8,["title"]),_(S,{key:"batch-remove-tag",title:l.$t("batchRemoveTag")},{default:I(()=>[(o(!0),u(F,null,K(s.value,O=>(o(),V(f,{key:`batch-remove-tag-${O.id}`},{default:I(()=>[A(h(O.name),1)]),_:2},1024))),128))]),_:1},8,["title"])],64)):(o(),V(S,{key:"toggle-tag",title:l.$t("toggleTag")},{default:I(()=>[_(f,{key:"add-custom-tag"},{default:I(()=>[A("+ "+h(l.$t("addNewCustomTag")),1)]),_:1}),(o(!0),u(F,null,K(s.value,O=>(o(),V(f,{key:`toggle-tag-${O.id}`},{default:I(()=>[A(h(O.name)+" ",1),O.selected?(o(),V(L(ct),{key:0})):(o(),V(L(ft),{key:1}))]),_:2},1024))),128))]),_:1},8,["title"])),_(g),_(f,{key:"openFileLocationInNewTab"},{default:I(()=>[A(h(l.$t("openFileLocationInNewTab")),1)]),_:1}),_(f,{key:"openWithLocalFileBrowser"},{default:I(()=>[A(h(l.$t("openWithLocalFileBrowser")),1)]),_:1})],64)):k("",!0),_(g),_(f,{key:"rename"},{default:I(()=>[A(h(l.$t("rename")),1)]),_:1}),_(f,{key:"previewInNewWindow"},{default:I(()=>[A(h(l.$t("previewInNewWindow")),1)]),_:1}),_(f,{key:"download"},{default:I(()=>[A(h(l.$t("download")),1)]),_:1}),_(f,{key:"copyPreviewUrl"},{default:I(()=>[A(h(l.$t("copySourceFilePreviewLink")),1)]),_:1}),_(f,{key:"copyFilePath"},{default:I(()=>[A(h(l.$t("copyFilePath")),1)]),_:1})],64)):k("",!0)]}),_:1})}}}),M=i=>(Pe("data-v-4ea1ffe2"),i=i(),$e(),i),Ai={class:"changeIndicatorWrapper"},_i={key:0,class:"changeIndicatorsLeft changeIndicators"},Ii={key:0,class:"promptChangeIndicator changeIndicator"},wi={key:1,class:"negpromptChangeIndicator changeIndicator"},Ci={key:2,class:"seedChangeIndicator changeIndicator"},Ti={key:3,class:"stepsChangeIndicator changeIndicator"},Ei={key:4,class:"cfgChangeIndicator changeIndicator"},Pi={key:5,class:"sizeChangeIndicator changeIndicator"},$i={key:6,class:"modelChangeIndicator changeIndicator"},Oi={key:7,class:"samplerChangeIndicator changeIndicator"},Di={key:8,class:"otherChangeIndicator changeIndicator"},Ni={class:"hoverOverlay"},zi=M(()=>a("strong",null,"This file",-1)),Mi=M(()=>a("br",null,null,-1)),Qi=M(()=>a("br",null,null,-1)),Bi={key:0},Fi=M(()=>a("td",null,[a("span",{class:"promptChangeIndicator"},"+ Prompt")],-1)),Ri={key:1},Li=M(()=>a("td",null,[a("span",{class:"negpromptChangeIndicator"},"- Prompt")],-1)),ji={key:2},Vi=M(()=>a("td",null,[a("span",{class:"seedChangeIndicator"},"Seed")],-1)),Hi={key:3},Ui=M(()=>a("td",null,[a("span",{class:"stepsChangeIndicator"},"Steps")],-1)),Ji={key:4},xi=M(()=>a("td",null,[a("span",{class:"cfgChangeIndicator"},"Cfg Scale")],-1)),Wi={key:5},Ki=M(()=>a("td",null,[a("span",{class:"sizeChangeIndicator"},"Size")],-1)),Gi={key:6},Yi=M(()=>a("td",null,[a("span",{class:"modelChangeIndicator"},"Model")],-1)),qi=M(()=>a("br",null,null,-1)),Zi={key:7},Xi=M(()=>a("td",null,[a("span",{class:"samplerChangeIndicator"},"Sampler")],-1)),es=M(()=>a("br",null,null,-1)),ts=M(()=>a("br",null,null,-1)),ns={key:0},is=M(()=>a("span",{class:"otherChangeIndicator"},"Other",-1)),ss=M(()=>a("br",null,null,-1)),rs=M(()=>a("br",null,null,-1)),os={key:1,class:"changeIndicatorsRight changeIndicators"},ls={key:0,class:"promptChangeIndicator changeIndicator"},as={key:1,class:"negpromptChangeIndicator changeIndicator"},ds={key:2,class:"seedChangeIndicator changeIndicator"},us={key:3,class:"stepsChangeIndicator changeIndicator"},cs={key:4,class:"cfgChangeIndicator changeIndicator"},fs={key:5,class:"sizeChangeIndicator changeIndicator"},hs={key:6,class:"modelChangeIndicator changeIndicator"},gs={key:7,class:"samplerChangeIndicator changeIndicator"},ps={key:8,class:"otherChangeIndicator changeIndicator"},vs={class:"hoverOverlay"},ms=M(()=>a("strong",null,"This file",-1)),ys=M(()=>a("br",null,null,-1)),bs=M(()=>a("br",null,null,-1)),Ss={key:0},ks=M(()=>a("td",null,[a("span",{class:"promptChangeIndicator"},"+ Prompt")],-1)),As={key:1},_s=M(()=>a("td",null,[a("span",{class:"negpromptChangeIndicator"},"- Prompt")],-1)),Is={key:2},ws=M(()=>a("td",null,[a("span",{class:"seedChangeIndicator"},"Seed")],-1)),Cs={key:3},Ts=M(()=>a("td",null,[a("span",{class:"stepsChangeIndicator"},"Steps")],-1)),Es={key:4},Ps=M(()=>a("td",null,[a("span",{class:"cfgChangeIndicator"},"Cfg Scale")],-1)),$s={key:5},Os=M(()=>a("td",null,[a("span",{class:"sizeChangeIndicator"},"Size")],-1)),Ds={key:6},Ns=M(()=>a("td",null,[a("span",{class:"modelChangeIndicator"},"Model")],-1)),zs=M(()=>a("br",null,null,-1)),Ms={key:7},Qs=M(()=>a("td",null,[a("span",{class:"samplerChangeIndicator"},"Sampler")],-1)),Bs=M(()=>a("br",null,null,-1)),Fs=M(()=>a("br",null,null,-1)),Rs={key:0},Ls=M(()=>a("span",{class:"otherChangeIndicator"},"Other",-1)),js=M(()=>a("br",null,null,-1)),Vs=M(()=>a("br",null,null,-1)),Hs=ne({__name:"ChangeIndicator",props:{genDiffToPrevious:{},genDiffToNext:{},genInfo:{}},setup(i){function n(t){const s=["prompt","negativePrompt","seed","steps","cfgScale","size","Model","others"],l=Object.keys(t).filter(v=>!s.includes(v));return Object.fromEntries(l.map(v=>[v,t[v]]))}function e(t){return Object.keys(n(t)).length>0}return(t,s)=>(o(),u("div",Ai,[t.genDiffToPrevious.empty?k("",!0):(o(),u("div",_i,["prompt"in t.genDiffToPrevious.diff?(o(),u("div",Ii,"P+")):k("",!0),"negativePrompt"in t.genDiffToPrevious.diff?(o(),u("div",wi,"P-")):k("",!0),"seed"in t.genDiffToPrevious.diff?(o(),u("div",Ci,"Se")):k("",!0),"steps"in t.genDiffToPrevious.diff?(o(),u("div",Ti,"St")):k("",!0),"cfgScale"in t.genDiffToPrevious.diff?(o(),u("div",Ei,"Cf")):k("",!0),"size"in t.genDiffToPrevious.diff?(o(),u("div",Pi,"Si")):k("",!0),"Model"in t.genDiffToPrevious.diff?(o(),u("div",$i,"Mo")):k("",!0),"Sampler"in t.genDiffToPrevious.diff?(o(),u("div",Oi,"Sa")):k("",!0),e(t.genDiffToPrevious.diff)?(o(),u("div",Di,"Ot")):k("",!0)])),a("div",Ni,[a("small",null,[_(L(xe)),zi,A(" vs "+h(t.genDiffToPrevious.otherFile)+" ",1),Mi,Qi,a("table",null,["prompt"in t.genDiffToPrevious.diff?(o(),u("tr",Bi,[Fi,a("td",null,h(t.genDiffToPrevious.diff.prompt)+" tokens changed",1)])):k("",!0),"negativePrompt"in t.genDiffToPrevious.diff?(o(),u("tr",Ri,[Li,a("td",null,h(t.genDiffToPrevious.diff.negativePrompt)+" tokens changed",1)])):k("",!0),"seed"in t.genDiffToPrevious.diff?(o(),u("tr",ji,[Vi,a("td",null,[a("strong",null,h(t.genDiffToPrevious.diff.seed[0]),1),A(" vs "+h(t.genDiffToPrevious.diff.seed[1]),1)])])):k("",!0),"steps"in t.genDiffToPrevious.diff?(o(),u("tr",Hi,[Ui,a("td",null,[a("strong",null,h(t.genDiffToPrevious.diff.steps[0]),1),A(" vs "+h(t.genDiffToPrevious.diff.steps[1]),1)])])):k("",!0),"cfgScale"in t.genDiffToPrevious.diff?(o(),u("tr",Ji,[xi,a("td",null,[a("strong",null,h(t.genDiffToPrevious.diff.cfgScale[0]),1),A(" vs "+h(t.genDiffToPrevious.diff.cfgScale[1]),1)])])):k("",!0),"size"in t.genDiffToPrevious.diff?(o(),u("tr",Wi,[Ki,a("td",null,[a("strong",null,h(t.genDiffToPrevious.diff.size[0]),1),A(" vs "+h(t.genDiffToPrevious.diff.size[1]),1)])])):k("",!0),"Model"in t.genDiffToPrevious.diff?(o(),u("tr",Gi,[Yi,a("td",null,[a("strong",null,h(t.genDiffToPrevious.diff.Model[0]),1),qi,A(" vs "+h(t.genDiffToPrevious.diff.Model[1]),1)])])):k("",!0),"Sampler"in t.genDiffToPrevious.diff?(o(),u("tr",Zi,[Xi,a("td",null,[a("strong",null,h(t.genDiffToPrevious.diff.Sampler[0]),1),es,A(" vs "+h(t.genDiffToPrevious.diff.Sampler[1]),1)])])):k("",!0)]),ts,e(t.genDiffToPrevious.diff)?(o(),u("div",ns,[is,A(" props that changed:"),ss,rs,a("ul",null,[(o(!0),u(F,null,K(n(t.genDiffToPrevious.diff),(l,v)=>(o(),u("li",null,h(v),1))),256))])])):k("",!0)])]),t.genDiffToNext.empty?k("",!0):(o(),u("div",os,["prompt"in t.genDiffToNext.diff?(o(),u("div",ls,"P+")):k("",!0),"negativePrompt"in t.genDiffToNext.diff?(o(),u("div",as,"P-")):k("",!0),"seed"in t.genDiffToNext.diff?(o(),u("div",ds,"Se")):k("",!0),"steps"in t.genDiffToNext.diff?(o(),u("div",us,"St")):k("",!0),"cfgScale"in t.genDiffToNext.diff?(o(),u("div",cs,"Cf")):k("",!0),"size"in t.genDiffToNext.diff?(o(),u("div",fs,"Si")):k("",!0),"Model"in t.genDiffToNext.diff?(o(),u("div",hs,"Mo")):k("",!0),"Sampler"in t.genDiffToNext.diff?(o(),u("div",gs,"Sa")):k("",!0),e(t.genDiffToNext.diff)?(o(),u("div",ps,"Ot")):k("",!0)])),a("div",vs,[a("small",null,[_(L(xe)),ms,A(" vs "+h(t.genDiffToNext.otherFile)+" ",1),ys,bs,a("table",null,["prompt"in t.genDiffToNext.diff?(o(),u("tr",Ss,[ks,a("td",null,h(t.genDiffToNext.diff.prompt)+" tokens changed",1)])):k("",!0),"negativePrompt"in t.genDiffToNext.diff?(o(),u("tr",As,[_s,a("td",null,h(t.genDiffToNext.diff.negativePrompt)+" tokens changed",1)])):k("",!0),"seed"in t.genDiffToNext.diff?(o(),u("tr",Is,[ws,a("td",null,[a("strong",null,h(t.genDiffToNext.diff.seed[0]),1),A(" vs "+h(t.genDiffToNext.diff.seed[1]),1)])])):k("",!0),"steps"in t.genDiffToNext.diff?(o(),u("tr",Cs,[Ts,a("td",null,[a("strong",null,h(t.genDiffToNext.diff.steps[0]),1),A(" vs "+h(t.genDiffToNext.diff.steps[1]),1)])])):k("",!0),"cfgScale"in t.genDiffToNext.diff?(o(),u("tr",Es,[Ps,a("td",null,[a("strong",null,h(t.genDiffToNext.diff.cfgScale[0]),1),A(" vs "+h(t.genDiffToNext.diff.cfgScale[1]),1)])])):k("",!0),"size"in t.genDiffToNext.diff?(o(),u("tr",$s,[Os,a("td",null,[a("strong",null,h(t.genDiffToNext.diff.size[0]),1),A(" vs "+h(t.genDiffToNext.diff.size[1]),1)])])):k("",!0),"Model"in t.genDiffToNext.diff?(o(),u("tr",Ds,[Ns,a("td",null,[a("strong",null,h(t.genDiffToNext.diff.Model[0]),1),zs,A(" vs "+h(t.genDiffToNext.diff.Model[1]),1)])])):k("",!0),"Sampler"in t.genDiffToNext.diff?(o(),u("tr",Ms,[Qs,a("td",null,[a("strong",null,h(t.genDiffToNext.diff.Sampler[0]),1),Bs,A(" vs "+h(t.genDiffToNext.diff.Sampler[1]),1)])])):k("",!0)]),Fs,e(t.genDiffToNext.diff)?(o(),u("div",Rs,[Ls,A(" props that changed:"),js,Vs,a("ul",null,[(o(!0),u(F,null,K(n(t.genDiffToNext.diff),(l,v)=>(o(),u("li",null,h(v),1))),256))])])):k("",!0)])])]))}});const Us=ut(Hs,[["__scopeId","data-v-4ea1ffe2"]]),Qe=i=>(Pe("data-v-e7eb7409"),i=i(),$e(),i),Js=["data-idx"],xs={key:1,class:"more"},Ws={class:"float-btn-wrap"},Ks={key:1,class:"tags-container"},Gs=["url"],Ys={class:"play-icon"},qs=["src"],Zs={key:0,class:"tags-container"},Xs=Qe(()=>a("div",{class:"audio-icon"},"",-1)),er={key:0,class:"tags-container"},tr={key:5,class:"preview-icon-wrap"},nr={key:1,class:"dir-cover-container"},ir=["src"],sr={key:3,class:"folder-stats-overlay"},rr={key:0,class:"stats-section"},or=Qe(()=>a("div",{class:"stats-title"}," Top Tags",-1)),lr={class:"stats-items"},ar={key:1,class:"stats-section"},dr=Qe(()=>a("div",{class:"stats-title"}," Top Words",-1)),ur={class:"stats-items"},cr={key:6,class:"profile"},fr=["title"],hr={class:"basic-info"},gr={style:{"margin-right":"4px"}},le=160,pr=ne({__name:"FileItem",props:{file:{},idx:{},selected:{type:Boolean,default:!1},showMenuIdx:{},cellWidth:{},fullScreenPreviewImageUrl:{},enableRightClickMenu:{type:Boolean,default:!0},enableCloseIcon:{type:Boolean,default:!1},isSelectedMutilFiles:{type:Boolean},genInfo:{},enableChangeIndicator:{type:Boolean},extraTags:{},coverFiles:{},folderStats:{},getGenDiff:{},getGenDiffWatchDep:{}},emits:["update:showMenuIdx","fileItemClick","dragstart","dragend","previewVisibleChange","contextMenuClick","close-icon-click","tiktokView"],setup(i,{emit:n}){const e=i;nn(r=>({"1ccb3500":r.$props.cellWidth+"px"}));const t=Ee(),s=nt(),l=U(),v=U(),f=be(()=>{const{getGenDiff:r,file:p,idx:w}=e;r&&(v.value=r(p.gen_info_obj,w,1,p),l.value=r(p.gen_info_obj,w,-1,p))},200+100*Math.random());ce(()=>{var r;return(r=e.getGenDiffWatchDep)==null?void 0:r.call(e,e.idx)},()=>{f()},{immediate:!0,deep:!0});const g=x(()=>s.tagMap.get(e.file.fullpath)??[]),S=x(()=>{const r=t.gridThumbnailResolution;return t.enableThumbnail?je(e.file,[r,r].join("x")):sn(e.file)}),$=x(()=>{var r;return(((r=t.conf)==null?void 0:r.all_custom_tags)??[]).reduce((p,w)=>[...p,{...w,selected:!!g.value.find(b=>b.id===w.id)}],[])}),E=x(()=>$.value.find(r=>r.type==="custom"&&r.name==="like")),O=()=>{ye(E.value),n("contextMenuClick",{key:`toggle-tag-${E.value.id}`},e.file,e.idx)},Q=r=>{let p=r.match(/(\d{4})-(\d{2})-(\d{2})\s(\d{2}:\d{2})/);return p?`${p[1].slice(-2)}-${p[2]}-${p[3]} ${p[4]}`:(p=r.match(/(\d{2})\.(\d{2})\.(\d{4})\s(\d{2}:\d{2})/),p?`${p[3].slice(-2)}-${p[2]}-${p[1]} ${p[4]}`:r)},d=r=>{t.magicSwitchTiktokView&&e.file.type==="file"&&Se(e.file.name)?(r.stopPropagation(),r.preventDefault(),n("tiktokView",e.file,e.idx),setTimeout(()=>{dn()},500)):n("fileItemClick",r,e.file,e.idx)},c=()=>{t.magicSwitchTiktokView?n("tiktokView",e.file,e.idx):un(e.file,r=>n("contextMenuClick",{key:`toggle-tag-${r}`},e.file,e.idx),()=>n("tiktokView",e.file,e.idx))},y=()=>{t.magicSwitchTiktokView?n("tiktokView",e.file,e.idx):cn(e.file,r=>n("contextMenuClick",{key:`toggle-tag-${r}`},e.file,e.idx),()=>n("tiktokView",e.file,e.idx))};return(r,p)=>{const w=ee,b=at,T=dt,D=fn,R=bn;return o(),V(w,{trigger:["contextmenu"],visible:L(t).longPressOpenContextMenu?typeof r.idx=="number"&&r.showMenuIdx===r.idx:void 0,"onUpdate:visible":p[7]||(p[7]=N=>typeof r.idx=="number"&&n("update:showMenuIdx",N?r.idx:-1))},{overlay:I(()=>[r.enableRightClickMenu?(o(),V(qe,{key:0,file:r.file,idx:r.idx,"selected-tag":g.value,onContextMenuClick:p[6]||(p[6]=(N,H,m)=>n("contextMenuClick",N,H,m)),"is-selected-mutil-files":r.isSelectedMutilFiles},null,8,["file","idx","selected-tag","is-selected-mutil-files"])):k("",!0)]),default:I(()=>{var N,H,m,B,z,j,P,W,J,Z;return[(o(),u("li",{class:G(["file file-item-trigger grid",{clickable:r.file.type==="dir",selected:r.selected}]),"data-idx":r.idx,key:r.file.name,draggable:"true",onDragstart:p[3]||(p[3]=C=>n("dragstart",C,r.idx)),onDragend:p[4]||(p[4]=C=>n("dragend",C,r.idx)),onClickCapture:p[5]||(p[5]=C=>d(C))},[a("div",null,[r.enableCloseIcon?(o(),u("div",{key:0,class:"close-icon",onClick:p[0]||(p[0]=C=>n("close-icon-click"))},[_(L(rn))])):k("",!0),r.enableRightClickMenu?(o(),u("div",xs,[_(w,null,{overlay:I(()=>[_(qe,{file:r.file,idx:r.idx,"selected-tag":g.value,onContextMenuClick:p[1]||(p[1]=(C,Y,bt)=>n("contextMenuClick",C,Y,bt)),"is-selected-mutil-files":r.isSelectedMutilFiles},null,8,["file","idx","selected-tag","is-selected-mutil-files"])]),default:I(()=>[a("div",Ws,[_(L(on))])]),_:1}),r.file.type==="file"?(o(),V(w,{key:0},{overlay:I(()=>[$.value.length>1?(o(),V(T,{key:0,onClick:p[2]||(p[2]=C=>n("contextMenuClick",C,r.file,r.idx))},{default:I(()=>[(o(!0),u(F,null,K($.value,C=>(o(),V(b,{key:`toggle-tag-${C.id}`},{default:I(()=>[A(h(C.name)+" ",1),C.selected?(o(),V(L(ct),{key:0})):(o(),V(L(ft),{key:1}))]),_:2},1024))),128))]),_:1})):k("",!0)]),default:I(()=>{var C,Y;return[a("div",{class:G(["float-btn-wrap",{"like-selected":(C=E.value)==null?void 0:C.selected}]),onClick:O},[(Y=E.value)!=null&&Y.selected?(o(),V(L(ln),{key:0})):(o(),V(L(an),{key:1}))],2)]}),_:1})):k("",!0)])):k("",!0),L(Se)(r.file.name)?(o(),u("div",{key:r.file.fullpath,class:G(`idx-${r.idx} item-content`)},[r.enableChangeIndicator&&v.value&&l.value?(o(),V(Us,{key:0,"gen-diff-to-next":v.value,"gen-diff-to-previous":l.value},null,8,["gen-diff-to-next","gen-diff-to-previous"])):k("",!0),_(D,{src:S.value,fallback:L(Fn),preview:{src:r.fullScreenPreviewImageUrl,onVisibleChange:(C,Y)=>n("previewVisibleChange",C,Y)}},null,8,["src","fallback","preview"]),g.value&&r.cellWidth>le?(o(),u("div",Ks,[(o(!0),u(F,null,K(r.extraTags??g.value,C=>(o(),V(R,{key:C.id,color:L(s).getColor(C)},{default:I(()=>[A(h(C.name),1)]),_:2},1032,["color"]))),128))])):k("",!0)],2)):L(st)(r.file.name)?(o(),u("div",{key:3,class:G(`idx-${r.idx} item-content video`),url:L(ve)(r.file),style:lt({"background-image":`url('${r.file.cover_url??L(ve)(r.file)}')`}),onClick:c},[a("div",Ys,[a("img",{src:L(xn),style:{width:"40px",height:"40px"}},null,8,qs)]),g.value&&r.cellWidth>le?(o(),u("div",Zs,[(o(!0),u(F,null,K(g.value,C=>(o(),V(R,{key:C.id,color:L(s).getColor(C)},{default:I(()=>[A(h(C.name),1)]),_:2},1032,["color"]))),128))])):k("",!0)],14,Gs)):L(rt)(r.file.name)?(o(),u("div",{key:4,class:G(`idx-${r.idx} item-content audio`),onClick:y},[Xs,g.value&&r.cellWidth>le?(o(),u("div",er,[(o(!0),u(F,null,K(g.value,C=>(o(),V(R,{key:C.id,color:L(s).getColor(C)},{default:I(()=>[A(h(C.name),1)]),_:2},1032,["color"]))),128))])):k("",!0)],2)):(o(),u("div",tr,[r.file.type==="file"?(o(),V(L(Cn),{key:0,class:"icon center"})):(N=r.coverFiles)!=null&&N.length&&r.cellWidth>160?(o(),u("div",nr,[(o(!0),u(F,null,K(r.coverFiles,C=>(o(),u("img",{class:"dir-cover-item",src:C.media_type==="image"?L(je)(C):L(ve)(C),key:C.fullpath},null,8,ir))),128))])):(o(),V(L($n),{key:2,class:"icon center"})),r.file.type==="dir"&&r.folderStats&&((H=r.folderStats.top_tags)!=null&&H.length||(B=(m=r.folderStats.prompt_analysis)==null?void 0:m.top_words)!=null&&B.length)?(o(),u("div",sr,[(z=r.folderStats.top_tags)!=null&&z.length?(o(),u("div",rr,[or,a("div",lr,[(o(!0),u(F,null,K(r.folderStats.top_tags.slice(0,3),C=>(o(),u("span",{key:C.tag_name,class:"stats-tag"},[A(h(C.tag_name)+" ",1),a("small",null,"("+h(C.count)+")",1)]))),128))])])):k("",!0),(P=(j=r.folderStats.prompt_analysis)==null?void 0:j.top_words)!=null&&P.length?(o(),u("div",ar,[dr,a("div",ur,[(o(!0),u(F,null,K(r.folderStats.prompt_analysis.top_words.slice(0,3),C=>(o(),u("span",{key:C.word,class:"stats-word"},[A(h(C.word)+" ",1),a("small",null,"("+h(C.count)+")",1)]))),128))])])):k("",!0)])):k("",!0)])),r.cellWidth>le?(o(),u("div",cr,[a("div",{class:"name line-clamp-1",title:r.file.name},h(r.file.name),9,fr),a("div",hr,[a("div",gr,[r.file.type==="dir"&&r.folderStats?(o(),u(F,{key:0},[r.folderStats.media_file_count!==void 0&&r.folderStats.media_file_count>0?(o(),u(F,{key:0},[A(" "+h(r.folderStats.media_file_count),1)],64)):((W=r.folderStats.media_stats)==null?void 0:W.indexed_media)>0?(o(),u(F,{key:1},[A(" "+h(r.folderStats.media_stats.indexed_media),1)],64)):k("",!0),((J=r.folderStats.media_stats)==null?void 0:J.indexed_media)>0&&((Z=r.folderStats.media_stats)==null?void 0:Z.tagged_images)>0?(o(),u(F,{key:2},[A(" "+h(r.folderStats.media_stats.tagged_images),1)],64)):k("",!0),r.folderStats.subfolder_count!==void 0&&r.folderStats.subfolder_count>0?(o(),u(F,{key:3},[A(" "+h(r.folderStats.subfolder_count),1)],64)):k("",!0)],64)):r.file.type==="dir"&&!r.folderStats?(o(),u(F,{key:1},[A(h(r.file.type)+" "+h(r.file.size),1)],64)):(o(),u(F,{key:2},[A(h(r.file.type)+" "+h(r.file.size),1)],64))]),a("div",null,[r.file.type==="dir"?(o(),u(F,{key:0},[A(h(Q(r.file.date)),1)],64)):(o(),u(F,{key:1},[A(h(r.file.date),1)],64))])])])):k("",!0)])],42,Js))]}),_:1},8,["visible"])}}});const Dr=ut(pr,[["__scopeId","data-v-e7eb7409"]]);export{Dr as F,Ar as N,qe as _,_r as a,Or as b,$r as c,yt as d,Pr as e,Wn as f,X as g,Cr as h,Er as i,wr as j,Tr as k,Bn as r,Ir as s,Gn as t,he as u};
